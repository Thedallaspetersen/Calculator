<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Built With Intention – Macro & Timeline Calculator</title>
<style>
  :root{
    --bg:#0f0f12; --card:#17171b; --ink:#e7e7f0; --muted:#a7a7b3;
    --accent:#4da6ff; --ok:#2ecc71; --chip:#222228; --line:#2a2a31;
  }
  *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
  body{margin:0;background:var(--bg);color:var(--ink)}
  header{padding:22px 18px;text-align:center}
  header h1{margin:0;font-size:1.6rem}
  header p{margin:.25rem 0 0;color:var(--muted)}

  .wrap{max-width:1024px;margin:0 auto;padding:12px}
  .grid{display:grid;gap:12px}
  @media(min-width:900px){ .grid{grid-template-columns:1fr 1fr} }

  .card{background:var(--card);border:1px solid #26262c;border-radius:14px;padding:16px}
  .card h3{margin:0 0 10px;font-size:1.05rem}
  label{display:block;margin:.35rem 0 .25rem;color:var(--muted);font-size:.9rem}
  input, select{width:100%;padding:12px 12px;border-radius:10px;border:1px solid var(--line);background:#121217;color:var(--ink);outline:none}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}

  .btn{width:100%;margin-top:12px;padding:14px;border-radius:12px;border:0;background:var(--accent);color:white;font-weight:700;cursor:pointer}

  .result{font-size:1.05rem;line-height:1.65}
  .kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:12px}
  .tile{background:#121217;border:1px solid var(--line);border-radius:12px;padding:12px;text-align:center}
  .tile b{display:block;font-size:1.3rem;margin-top:6px}

  .note{margin-top:10px;color:var(--muted);font-size:.9rem}
  footer{padding:28px;text-align:center;color:var(--muted);font-size:.85rem}

  /* ------- Body-fat image grids ------- */
  .bf-wrap{margin-top:8px}
  .bf-grid{
    display:grid;
    grid-template-columns:repeat(5,1fr); /* 5 columns */
    grid-template-rows:repeat(2,auto);   /* 2 rows */
    gap:10px;
  }
  /* tile */
  .bf-tile{
    background:#111216;
    border:1px solid var(--line);
    border-radius:12px;
    padding:8px 8px 10px;
    cursor:pointer;
    transition:border .15s ease, box-shadow .15s ease, transform .15s ease;
  }
  .bf-tile.active{
    border:1px solid var(--accent);
    box-shadow:0 0 0 3px color-mix(in srgb, var(--accent), transparent 75%);
    transform:translateY(-1px);
  }
  /* image wrapper to allow 3% scale without cropping the full image */
  .bf-img-box{
    position:relative;
    width:100%;
    height:110px;             /* tuned for portrait fit */
    background:#0f1116;
    border-radius:10px;
    overflow:hidden;          /* keeps the zoom tidy inside box */
    padding:3%;               /* gives headroom for scale so full image stays visible */
    display:flex;align-items:center;justify-content:center;
  }
  .bf-img{
    width:100%;
    height:100%;
    object-fit:contain;       /* show the ENTIRE image (no crop) */
    transform:scale(1.03);    /* ~3% zoom to hide minor crop edges, kept inside via padding */
    transform-origin:center center;
    border-radius:8px;
    image-rendering:auto;
    -webkit-user-drag:none;
    user-select:none;
  }
  .bf-label{
    margin-top:6px;
    font-size:.9rem;
    font-weight:700;
    text-align:center;
    color:#fff;               /* white % label outside the picture */
  }

  /* Tighten layout on very small devices */
  @media(max-width:420px){
    .bf-img-box{ height:96px; }
    .bf-label{ font-size:.85rem; }
    .kpi{ grid-template-columns:repeat(2,1fr); }
  }
</style>
</head>
<body>
<header>
  <h1>Built With Intention • Macro & Timeline Calculator</h1>
  <p>Answer a few questions. We’ll estimate protein, calories, weekly loss, and weeks to your goal.</p>
</header>

<div class="wrap grid">
  <!-- LEFT: inputs -->
  <section class="card">
    <h3>About you</h3>
    <div class="row">
      <div>
        <label>Age</label><input id="age" type="number" inputmode="numeric" placeholder="age">
      </div>
      <div>
        <label>Sex</label>
        <select id="sex"><option value="male">Male</option><option value="female">Female</option></select>
      </div>
    </div>

    <div class="row">
      <div>
        <label>Height</label>
        <select id="heightUnit">
          <option value="ftin" selected>feet/inches</option>
          <option value="cm">centimeters</option>
        </select>
        <div class="row" id="ftin">
          <input id="ft" type="number" inputmode="numeric" placeholder="ft">
          <input id="inch" type="number" inputmode="numeric" placeholder="in">
        </div>
        <input id="cm" type="number" inputmode="numeric" placeholder="cm" style="display:none;margin-top:8px">
      </div>
      <div>
        <label>Weight</label>
        <div class="row">
          <input id="weight" type="number" inputmode="numeric" placeholder="weight">
          <select id="wUnit"><option value="lb" selected>lb</option><option value="kg">kg</option></select>
        </div>
      </div>
    </div>

    <h3 style="margin-top:16px">Activity</h3>
    <label>Work Activity</label>
    <select id="work">
      <option value="light" selected>Light Activity – Desk</option>
      <option value="moderate">Moderate Activity – Retail/Service</option>
      <option value="high">High Activity – Labor</option>
    </select>

    <label style="margin-top:8px">Training (gym)</label>
    <select id="training">
      <option value="0">No training</option>
      <option value="1-2">1–2 sessions/week</option>
      <option value="3-4" selected>3–4 sessions/week</option>
      <option value="5-6">5–6 sessions/week</option>
    </select>

    <label style="margin-top:8px">Cardio (hours/week)</label>
    <select id="cardio">
      <option value="0" selected>None</option>
      <option value="1-2">1–2 hours</option>
      <option value="3-4">3–4 hours</option>
      <option value="5-6">5–6 hours</option>
    </select>

    <!-- Current look -->
    <h3 style="margin-top:18px">Pick your current look (body-fat approximation)</h3>
    <div id="bfCurrent" class="bf-wrap">
      <div class="bf-grid" id="bfGridCurrent">
        <!-- tiles injected by JS -->
      </div>
    </div>

    <!-- Goal look -->
    <h3 style="margin-top:18px">Pick your goal look</h3>
    <div id="bfGoal" class="bf-wrap">
      <div class="bf-grid" id="bfGridGoal">
        <!-- tiles injected by JS -->
      </div>
    </div>

    <button class="btn" id="calc">Calculate</button>
  </section>

  <!-- RIGHT: results -->
  <section class="card">
    <h3>Your Plan</h3>
    <div class="result" id="result">
      Fill the form and tap <b>Calculate</b>.
    </div>
    <div class="kpi" id="kpi" style="display:none">
      <div class="tile"><span class="muted">Protein (g/day)</span><b id="kProtein">—</b></div>
      <div class="tile"><span class="muted">Calories / day</span><b id="kCals">—</b></div>
      <div class="tile"><span class="muted">Weeks to goal</span><b id="kWeeks">—</b></div>
      <div class="tile"><span class="muted">Weekly Loss (lb)</span><b id="kWeeklyLoss">—</b></div>
    </div>
    <div class="note" id="note" style="display:none"></div>
  </section>
</div>

<footer>© Built With Intention • Educational estimates only</footer>

<script>
/* ---------------- helpers ---------------- */
function el(id){ return document.getElementById(id); }
function round(x, n=0){ const p = Math.pow(10,n); return Math.round(x*p)/p; }

/* BF bands (labels we show under images) */
const bfBandsMale = [
  {label:'8–10%',  value:0.09,  file:'MaleBody8.jpeg'},
  {label:'11–12%', value:0.115, file:'MaleBody11.jpeg'},
  {label:'13–14%', value:0.135, file:'MaleBody13.jpeg'},
  {label:'15–17%', value:0.16,  file:'MaleBody15.jpeg'},
  {label:'18–19%', value:0.185, file:'MaleBody18.jpeg'},
  {label:'20–22%', value:0.21,  file:'MaleBody20.jpeg'},
  {label:'23–24%', value:0.235, file:'MaleBody23.jpeg'},
  {label:'25–29%', value:0.27,  file:'MaleBody25.jpeg'},
  {label:'30–34%', value:0.32,  file:'MaleBody30.jpeg'},
  {label:'35–40%', value:0.375, file:'MaleBody35.jpeg'}
];

const bfBandsFemale = [
  {label:'16–18%', value:0.17,  file:'FemaleBody16.jpeg'},
  {label:'19–21%', value:0.20,  file:'FemaleBody19.jpeg'},
  {label:'22–24%', value:0.23,  file:'FemaleBody22.jpeg'},
  {label:'25–27%', value:0.26,  file:'FemaleBody25.jpeg'},
  {label:'28–30%', value:0.29,  file:'FemaleBody28.jpeg'},
  {label:'31–34%', value:0.325, file:'FemaleBody31.jpeg'},
  {label:'35–38%', value:0.365, file:'FemaleBody35.jpeg'},
  {label:'39–42%', value:0.405, file:'FemaleBody39.jpeg'},
  {label:'43–46%', value:0.445, file:'FemaleBody43.jpeg'},
  {label:'47–50%', value:0.485, file:'FemaleBody47.jpeg'}
];

/* build tiles for current/goal grids */
function buildBFGrid(gridId, sex){
  const grid = el(gridId);
  grid.innerHTML = '';
  const items = (sex==='female') ? bfBandsFemale : bfBandsMale;

  items.forEach((it, idx)=>{
    const tile = document.createElement('div');
    tile.className = 'bf-tile';
    tile.dataset.value = it.value;

    const box = document.createElement('div');
    box.className = 'bf-img-box';

    const img = document.createElement('img');
    img.className = 'bf-img';
    img.alt = it.label;
    img.src = `images/${it.file}`;

    const lab = document.createElement('div');
    lab.className = 'bf-label';
    lab.textContent = it.label;

    box.appendChild(img);
    tile.appendChild(box);
    tile.appendChild(lab);
    grid.appendChild(tile);

    tile.addEventListener('click', ()=>{
      // clear actives only inside this grid
      [...grid.children].forEach(c=>c.classList.remove('active'));
      tile.classList.add('active');
    });
  });
}

/* get selected BF from a grid container */
function getSelectedBF(gridId){
  const grid = el(gridId);
  const selected = grid.querySelector('.bf-tile.active');
  return selected ? Number(selected.dataset.value) : null;
}

/* height switch */
el('heightUnit').onchange = ()=>{
  const m = el('heightUnit').value==='cm';
  el('ftin').style.display = m? 'none':'grid';
  el('cm').style.display   = m? 'block':'none';
};

/* build initial grids (male default) */
buildBFGrid('bfGridCurrent', el('sex').value);
buildBFGrid('bfGridGoal',    el('sex').value);

/* rebuild grids when sex changes */
el('sex').onchange = ()=>{
  buildBFGrid('bfGridCurrent', el('sex').value);
  buildBFGrid('bfGridGoal',    el('sex').value);
};

/* activity multiplier (work + gym + cardio)
   Work base: Light 1.425, Moderate 1.55, High 1.75
   Gym add:   1–2 +0.05, 3–4 +0.10, 5–6 +0.20
   Cardio:    None +0.00, 1–2h +0.05, 3–4h +0.10, 5–6h +0.15
*/
function activityMultiplier(work, training, cardio){
  let base = 1.425;
  if(work==='moderate') base = 1.55;
  if(work==='high')     base = 1.75;

  let addGym = 0;
  if(training==='1-2') addGym = 0.05;
  if(training==='3-4') addGym = 0.10;
  if(training==='5-6') addGym = 0.20;

  let addCardio = 0;
  if(cardio==='1-2') addCardio = 0.05;
  if(cardio==='3-4') addCardio = 0.10;
  if(cardio==='5-6') addCardio = 0.15;

  return base + addGym + addCardio;
}

/* BMR (Mifflin-St Jeor) */
function bmr(sex, kg, cm, age){
  return sex==='male'
    ? 10*kg + 6.25*cm - 5*age + 5
    : 10*kg + 6.25*cm - 5*age - 161;
}

el('calc').onclick = ()=>{
  // inputs
  const age   = Number(el('age').value||0);
  const sex   = el('sex').value;

  // height
  let cm = 0;
  if(el('heightUnit').value==='cm'){
    cm = Number(el('cm').value||0);
  }else{
    const ft = Number(el('ft').value||0);
    const inch = Number(el('inch').value||0);
    cm = (ft*12 + inch) * 2.54;
  }

  // weight
  let kg = Number(el('weight').value||0);
  if(el('wUnit').value==='lb') kg = kg * 0.45359237;
  const lb = kg / 0.45359237;

  // activity
  const mult = activityMultiplier(
    el('work').value,
    el('training').value,
    el('cardio').value
  );

  // bodyfat selections (from image grids)
  const bfCur  = getSelectedBF('bfGridCurrent');
  const bfGoal = getSelectedBF('bfGridGoal');

  if(!age || !cm || !kg || !bfCur || !bfGoal){
    el('result').innerHTML = "Please complete all fields and select your current and goal looks.";
    el('kpi').style.display='none';
    el('note').style.display='none';
    return;
  }
  if(bfGoal >= bfCur){
    el('result').innerHTML = "Goal body-fat must be lower than current for a fat-loss timeline.";
    el('kpi').style.display='none';
    el('note').style.display='none';
    return;
  }

  // calculations
  const _bmr = bmr(sex, kg, cm, age);
  const tdee = _bmr * mult;

  // lean mass assumed constant
  const leanMass_kg = kg * (1 - bfCur);
  const goalWeight_kg = leanMass_kg / (1 - bfGoal);
  const goalWeight_lb = goalWeight_kg / 0.45359237;

  const fatToLose_lb = Math.max(0, lb - goalWeight_lb); // lbs

  // 1% per week rule
  const weeklyLossTarget_lb = lb * 0.01;
  const targetDailyDeficit_kcal = (weeklyLossTarget_lb * 3500) / 7;

  // calorie target + safety floor
  const safetyFloor = (sex==='male') ? 1600 : 1300;
  let calories = tdee - targetDailyDeficit_kcal;
  let floorApplied = false;
  if(calories < safetyFloor){
    calories = safetyFloor;
    floorApplied = true;
  }

  // achievable weekly loss
  const achievableWeeklyLoss_lb = floorApplied
    ? Math.max(0, ((tdee - calories) * 7) / 3500)
    : weeklyLossTarget_lb;

  // weeks to goal
  const weeks = achievableWeeklyLoss_lb > 0
    ? fatToLose_lb / achievableWeeklyLoss_lb
    : 0;

  // protein: ~1.0 g / lb of GOAL body weight (min 100 g)
  const protein_g = Math.max(100, goalWeight_lb * 1.0);

  // output
  el('kProtein').textContent    = Math.round(protein_g);
  el('kCals').textContent       = Math.round(calories);
  el('kWeeks').textContent      = Math.max(1, Math.round(weeks));
  el('kWeeklyLoss').textContent = round(achievableWeeklyLoss_lb, 1);

  el('kpi').style.display='grid';
  el('result').innerHTML = `
    <p><b>TDEE:</b> ${Math.round(tdee)} kcal/day (work + training + cardio)</p>
    <p><b>Current BF:</b> ${Math.round(bfCur*100)}% • <b>Goal BF:</b> ${Math.round(bfGoal*100)}%<br>
    <b>Start Weight:</b> ${round(lb,1)} lb • <b>Goal Weight (est.):</b> ${round(goalWeight_lb,1)} lb</p>
  `;

  if(floorApplied){
    el('note').style.display='block';
    el('note').innerHTML = `Note: Calories are capped at ${safetyFloor} kcal/day for safety. That limits weekly loss to about <b>${round(achievableWeeklyLoss_lb,1)} lb/week</b>, below the 1% target of <b>${round(weeklyLossTarget_lb,1)} lb/week</b>.`;
  }else{
    el('note').style.display='block';
    el('note').innerHTML = `Weekly loss set to <b>${round(weeklyLossTarget_lb,1)} lb/week</b> (1% of current body weight).`;
  }
};
</script>
</body>
</html>